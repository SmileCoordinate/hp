<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªå·±åˆ†æã‚·ãƒ¼ãƒˆ</title>
    <link rel="stylesheet" href="styles.css">
</head>
<style>
    /* å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f4f4f4;
        text-align: center;
        margin: 0;
        padding: 0;
    }

    /* ã‚³ãƒ³ãƒ†ãƒŠ */
    .container {
        width: 90%;
        max-width: 600px;
        background: white;
        padding: 20px;
        margin: 30px auto;
        border-radius: 10px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
    }

    /* ã‚¿ã‚¤ãƒˆãƒ« */
    h2 {
        font-size: 22px;
        font-weight: bold;
        margin-bottom: 10px;
    }

    /* è³ªå•ã®ãƒ†ã‚­ã‚¹ãƒˆ */
    p {
        font-size: 18px;
        font-weight: bold;
        color: #333;
        margin-bottom: 15px;
    }

    /* ãƒ•ã‚©ãƒ¼ãƒ å†…ã®è³ªå•ãƒ–ãƒ­ãƒƒã‚¯ */
    #questionContainer {
        text-align: left;
        margin-bottom: 20px;
    }

    /* è³ªå•ãƒ©ãƒ™ãƒ« */
    label {
        display: block;
        font-size: 16px;
        font-weight: normal;
        color: #555;
        margin-top: 10px;
    }

    /* ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› */
    input[type="text"] {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 16px;
    }

    /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ */
    input[type="radio"] {
        margin-right: 5px;
    }

    label input[type="radio"] {
        transform: scale(1.2);
    }

    /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
    .navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
    }

    button {
        width: 48%;
        padding: 12px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: 0.3s;
    }

    /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ */
    #prevBtn {
        background-color: #ddd;
        color: #333;
    }

    /* æ¬¡ã¸ãƒœã‚¿ãƒ³ */
    #nextBtn {
        background-color: #007bff;
        color: white;
    }

    /* ãƒœã‚¿ãƒ³ã®ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
    button:hover {
        opacity: 0.8;
    }
</style>

<body>

    <div class="container">
        <h2>è‡ªå·±åˆ†æã‚·ãƒ¼ãƒˆ</h2>
        <p>ã“ã‚Œã‹ã‚‰ã®è³ªå•ã®å›ç­”å†…å®¹ã¯ç´„1ã‚«æœˆé–“ä¿ç®¡ã„ãŸã—ã¾ã™ã€‚</p>

        <form id="surveyForm">
            <div id="questionContainer"></div>

            <div class="navigation">
                <button id="prevBtn" onclick="/* å¿…è¦ãªã‚‰æˆ»ã‚‹å‡¦ç† */">æˆ»ã‚‹</button>
                <button id="nextBtn" onclick="nextQuestion()">æ¬¡ã¸</button>
            </div>

        </form>
    </div>

    <script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbwvX3O6ipM-E2YaVG-Q-9U_Uefq9dbqEUm4VVSMRloTceHG1LFv6mw2rSH2Spw193ZpjQ/exec"; // ä¾‹: https://script.google.com/macros/s/xxxxx/exec

//è³ªå•ãŒé€²ã¾ãªã„
const questions = [
            {
                id: 1,
                text: "æœ€åˆã«ã‚ãªãŸã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„",
                fields: [
                    { label: "ãŠåå‰ã‚‚ã—ãã¯ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„", type: "text", id: "name", required: true },
                    { label: "æ€§åˆ¥ã‚’æ•™ãˆã¦ãã ã•ã„", type: "radio", id: "gender", options: ["ç”·æ€§", "å¥³æ€§"], required: true },
                    { label: "å¹´é½¢ã‚’æ•™ãˆã¦ãã ã•ã„", type: "select", id: "age", options: ["é¸æŠã—ã¦ãã ã•ã„", "10ä»£", "20ä»£", "30ä»£", "40ä»£", "50ä»£", "60ä»£", "70ä»£", "80ä»£", "90ä»£"], required: true },
                    { label: "ç„¡æ–™ç›¸è«‡ã¯å¸Œæœ›ã•ã‚Œã¾ã™ã‹", type: "radio", id: "consultation", options: ["ã¯ã„", "ã„ã„ãˆ"], required: true }
                ],
                next: 2
            },
            {
                id: 2,
                text: "ä»Šã€å›°ã£ã¦ã„ã‚‹ã“ã¨ã‚„æ‚©ã¿äº‹ã¯ã‚ã‚Šã¾ã™ã‹",
                type: "radio",
                options: ["ã¯ã„", "ã„ã„ãˆ"],
                required: true,
                next: { "ã¯ã„": 3, "ã„ã„ãˆ": 99 }
            },
            {
                id: 3,
                text: "ã“ã®ä¸­ã§æ‚©ã‚“ã§ã„ã‚‹äº‹ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ<br>æ‚©ã¿ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ã€‚",
                type: "radio",
                options: ["äººé–“é–¢ä¿‚", "å­è‚²ã¦", "æ•™è‚²", "ä»•äº‹é–¢é€£", "ãã®ä»–"],
                required: true,
                next: { "äººé–“é–¢ä¿‚": 10, "å­è‚²ã¦": 20, "æ•™è‚²": 30, "ä»•äº‹é–¢é€£": 40, "ãã®ä»–":4}
            },

            {
    id: 4,
    text: "ã©ã‚“ãªã“ã¨ã§æ‚©ã‚“ã§ã„ã‚‹ã®ã‹æ•™ãˆã¦ãã ã•ã„ğŸ™ğŸ»",
    type: "text",
    required: true,
    next: 99
},
            {
    id: 10,
    text: "ãã®äººã¨ã¯ã©ã‚“ãªäººã§ã™ã‹ï¼Ÿ",
    type: "radio",
    options: ["å®¶æ—", "è¦ªæ—", "è·å ´ã®ä¸Šå¸ã€éƒ¨ä¸‹ã€åŒåƒš", "å­¦æ ¡ã®å…ˆç”Ÿ", "å‹äººã‚„çŸ¥äºº", "ãã®ä»–"],
    required: true,
    next: 11
},
            {
    id: 11,
    text: "ã©ã®ã‚ˆã†ãªã“ã¨ã§æ‚©ã‚“ã§ã¾ã™ã‹ï¼Ÿ",
    type: "text",
    required: true,
    next: 98
},
{
                id: 98,
                text: "ä»–ã«æ‚©ã‚“ã§ã„ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
                type: "radio",
                options: ["ã¯ã„", "ã„ã„ãˆ"],
                required: true,
                next: { "ã¯ã„": 3, "ã„ã„ãˆ": 99 }
            },

            {
                id: 99,
                text: "ã”å›ç­”ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼",
                type: "message"
            }
        ];

let currentQuestionIndex = 0;
let answers = [];

function loadQuestion(index) {
    const questionContainer = document.getElementById("questionContainer");
    questionContainer.innerHTML = "";

    const question = questions[index];
    if (!question) return;

    // è³ªå•è¡¨ç¤º
    const questionText = document.createElement("p");
    questionText.innerHTML = question.text;
    questionContainer.appendChild(questionText);

    if (question.type === "radio") {
        question.options.forEach(option => {
            const label = document.createElement("label");
            const input = document.createElement("input");
            input.type = "radio";
            input.name = "answer";
            input.value = option;
            label.appendChild(input);
            label.appendChild(document.createTextNode(option));
            questionContainer.appendChild(label);
        });
    } else if (question.type === "text") {
        const input = document.createElement("textarea");
        input.id = "textAnswer";
        questionContainer.appendChild(input);
    } else if (question.fields) {
        question.fields.forEach(field => {
            const wrapper = document.createElement("div");
            const label = document.createElement("label");
            label.textContent = field.label;
            wrapper.appendChild(label);

            if (field.type === "text") {
                const input = document.createElement("input");
                input.type = "text";
                input.id = field.id;
                wrapper.appendChild(input);
            } else if (field.type === "radio") {
                field.options.forEach(option => {
                    const radioLabel = document.createElement("label");
                    const input = document.createElement("input");
                    input.type = "radio";
                    input.name = field.id;
                    input.value = option;
                    radioLabel.appendChild(input);
                    radioLabel.appendChild(document.createTextNode(option));
                    wrapper.appendChild(radioLabel);
                });
            } else if (field.type === "select") {
                const select = document.createElement("select");
                select.id = field.id;
                field.options.forEach(option => {
                    const opt = document.createElement("option");
                    opt.value = option;
                    opt.textContent = option;
                    select.appendChild(opt);
                });
                wrapper.appendChild(select);
            }

            questionContainer.appendChild(wrapper);
        });
    }

    // ãƒœã‚¿ãƒ³è¡¨ç¤ºåˆ¶å¾¡ï¼ˆ99ãªã‚‰éè¡¨ç¤ºï¼‰
    document.getElementById("nextBtn").style.display = (question.id === 99) ? "none" : "inline-block";
    document.getElementById("prevBtn").style.display = (question.id === 99) ? "none" : "inline-block";
}

function validateInputs(question) {
    if (question.fields) {
        return question.fields.every(field => {
            if (field.required) {
                if (field.type === "text") {
                    return document.getElementById(field.id).value.trim() !== "";
                } else if (field.type === "radio") {
                    return !!document.querySelector(`input[name="${field.id}"]:checked`);
                } else if (field.type === "select") {
                    return document.getElementById(field.id).value !== "é¸æŠã—ã¦ãã ã•ã„";
                }
            }
            return true;
        });
    } else if (question.type === "radio") {
        return !!document.querySelector('input[name="answer"]:checked');
    } else if (question.type === "text") {
        return document.getElementById("textAnswer").value.trim() !== "";
    }
    return true;
}

function nextQuestion() {
    const question = questions[currentQuestionIndex];

    if (!validateInputs(question)) {
        alert("ã™ã¹ã¦ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚");
        return;
    }

    const answerEntry = {
        id: question.id,
        type: question.type,
        question: question.text,
        answer: null
    };

    if (question.fields) {
        question.fields.forEach(field => {
            let value = "";
            if (field.type === "text") {
                value = document.getElementById(field.id).value;
            } else if (field.type === "radio") {
                const checked = document.querySelector(`input[name="${field.id}"]:checked`);
                if (checked) value = checked.value;
            } else if (field.type === "select") {
                value = document.getElementById(field.id).value;
            }
            answers.push({
                id: field.id,
                type: field.type,
                question: field.label,
                answer: value
            });
        });
    } else if (question.type === "radio") {
        const checked = document.querySelector('input[name="answer"]:checked');
        if (checked) answerEntry.answer = checked.value;
        answers.push(answerEntry);
    } else if (question.type === "text") {
        const text = document.getElementById("textAnswer").value;
        answerEntry.answer = text;
        answers.push(answerEntry);
    }

    const nextId = (typeof question.next === "object")
        ? question.next[answerEntry.answer]
        : question.next;

    const nextIndex = questions.findIndex(q => q.id === nextId);
    currentQuestionIndex = nextIndex;

    if (nextId === 99) {
        submitSurvey();
        displayThankYouMessage();
    } else {
        loadQuestion(nextIndex);
    }
}

function displayThankYouMessage() {
    const questionContainer = document.getElementById("questionContainer");
    questionContainer.innerHTML = `
        <h2>ã”å›ç­”ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h2>
        <p>ç°¡å˜ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼šã‚ãªãŸã®æ‚©ã¿ã«å¯„ã‚Šæ·»ã„ã€ä¸€ç·’ã«è§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
        <button onclick="restartSurvey()">ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</button>
    `;
    document.getElementById("nextBtn").style.display = "none";
    document.getElementById("prevBtn").style.display = "none";
}

function restartSurvey() {
    currentQuestionIndex = 0;
    answers = [];
    loadQuestion(currentQuestionIndex);
}

function submitSurvey() {
    fetch(GAS_URL, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ answers })
    })
    .then(() => console.log("é€ä¿¡å®Œäº†"))
    .catch(err => console.error("é€ä¿¡ã‚¨ãƒ©ãƒ¼:", err));
}

document.addEventListener("DOMContentLoaded", () => {
    loadQuestion(currentQuestionIndex);
});
    </script>

</body>

</html>